<!DOCTYPE html>
<html lang="en">
    <head>
        <title>QStats: The Ultimate Quaver Discord Bot</title>
        <meta name="Description" content="Get Quaver profiles, scores and more without ever leaving Discord.">
        <link rel="preload" as="style" type="text/css" href="style.css" onload="this.onload=null;this.rel='stylesheet'">
        <link rel="icon" type="image/svg+xml" href="logo.svg">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta name="theme-color" content="#1DC5FF"/>
    </head>
    <body>
        <div id="header-wrapper">
            <div id="header">
                <img src="FullTextLogo.svg">
                <p class="no-bottom">Get Quaver profiles, scores and more without ever leaving Discord.</p>
                <p id="join">Join <span id="gcount">many</span> other servers and invite QStats today.</p>
                <div class="section">
                    <a href="https://discordapp.com/oauth2/authorize?client_id=709881098561257516&scope=bot&permissions=0" class="button">
                        Invite!
                    </a>
                    <a href="https://github.com/ethanwritescode/QStats">
                        <div class="button">Github</div>
                    </a>
                    <a href="https://discord.gg/F7RBKh2">
                        <div class="button">Discord</div>
                    </a>
                </div>
            </div>
            <img src="gaming.png" id="bg-texture">
        </div>
<!--        <img src="wave.svg" class="wave">-->
        <div id="content">
            <div class="card-box">
                <div class="card">
                    <img src="stats.svg">
                    <div class="card-content">
                        <h2>Detailed score information</h2>
                        <p>View everything about scores players set, such as ratio, judgement counts, rating, and more.</p>
                    </div>
                </div>
                <div class="card">
                    <img src="map.svg">
                    <div class="card-content">
                        <h2>Instant map and mapset previews</h2>
                        <p>Paste a mapset/map link from Quaver into the chat and QStats will instantly give a preview of that map!</p>
                    </div>
                </div>
                <div class="card">
                    <img src="compare.svg">
                    <div class="card-content">
                        <h2>Compare your scores</h2>
                        <p>Whenever a map/set of maps are referenced in chat (whether this be from score commands/map URL linking), you can compare yours or someone else's score on that map!</p>
                    </div>
                </div>
                <div class="card">
                    <img src="link.svg">
                    <div class="card-content">
                        <h2>Link your Quaver account</h2>
                        <p>Link your username to run commands without needing to specify a username! Also, this command allows you to set your preferred keymode.</p>
                    </div>
                </div>
                <div class="card">
                    <img src="free.svg">
                    <div class="card-content">
                        <h2>No paywalled commands</h2>
                        <p>All features of QStats will be 100% free, forever.</p>
                    </div>
                </div>
                <div class="card">
                    <img src="open.svg">
                    <div class="card-content">
                        <h2>Open source</h2>
                        <p>QStats is free to modify and distribute within reason. If you're not sure how you can do this, read the LICENSE on the Github page.</p>
                    </div>
                </div>
            </div>
        </div>
        <div id="footer">
            <div id="footer-credits">
                <p>Developed by <a href="https://vysion.cc" style="color:#1DC5FF">Vysion#3272</a>. Mascot drawn by <a href="https://www.instagram.com/mayu.niki/" style="color:#1DC5FF">mayuniki</a>.</p>
            </div>
            <div id="status">
            </div>
        </div>
    </body>
    <script>
        // can u not look at this code thanks
        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0B';

            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];

            const i = Math.floor(Math.log(bytes) / Math.log(k));

            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }
        let req = new XMLHttpRequest();

        req.onreadystatechange = function() {
            if (req.readyState === 4 && req.status === 200) {
                const d = JSON.parse(req.responseText);
                document.getElementById("gcount").innerText = d.map((v) => { return v.shards.map((v2) => v2.guilds).reduce((a, b) => { return a + b}, 0)}).reduce((a, b) => { return a + b}, 0);
                console.log(d);

                for (let i = 0; i < d.length; i++) {
                    const baseDiv = document.createElement("div")
                    baseDiv.classList.add("cluster")

                    const clusterTitle = document.createElement("div");
                    clusterTitle.classList.add("cluster-title")
                    clusterTitle.appendChild(document.createTextNode(`Cluster ${i}`))
                    baseDiv.appendChild(clusterTitle);

                    const clusterStats = document.createElement("div");
                    clusterStats.classList.add("cluster-stats")
                    clusterStats.appendChild(document.createTextNode(`${formatBytes(d[i].heap)} heap - ${formatBytes(d[i].rss)} rss`))
                    baseDiv.appendChild(clusterStats);

                    const clusterContentDiv = document.createElement("div")
                    clusterContentDiv.classList.add("cluster-content")
                    baseDiv.appendChild(clusterContentDiv)

                    d[i].shards.forEach((s) => {
                        const shardDiv = document.createElement("div")
                        shardDiv.classList.add("shard")
                        const shardIDDiv = document.createElement("div");
                        shardIDDiv.classList.add("shard-id")
                        const shardContentDiv = document.createElement("div");
                        shardContentDiv.classList.add("shard-content")

                        shardIDDiv.appendChild(document.createTextNode(`Shard ${s.shardID}`))
                        shardContentDiv.appendChild(document.createTextNode(`${s.ping}ms - ${s.guilds} guilds`))

                        if (s.status === 0) {
                            shardDiv.classList.add("ok");
                        }
                        shardDiv.appendChild(shardIDDiv)
                        shardDiv.appendChild(shardContentDiv)
                        clusterContentDiv.appendChild(shardDiv);
                    })
                    document.getElementById("status").appendChild(baseDiv);
                }
            }
        }

        req.open( "GET", "https://qstatsdata.vysion.cc/", true ); // false for synchronous request
        req.send( null );



    </script>
</html>